<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>Axel — Оригинальная подготовка к экзамену</title>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@500;700&display=swap" rel="stylesheet">
  <style>
    /* ...оставьте ваш CSS без изменений... */
    .completed {
      color: #00c853;
      font-size: 1.2em;
      margin-left: 8px;
    }
    .exit-btn {
      background: #f06292;
      color: #fff;
      border-radius: 10px;
      padding: 8px 22px;
      font-size: 1em;
      font-weight: 700;
      border: none;
      cursor: pointer;
      margin-top: 10px;
      margin-left: 10px;
      transition: background 0.2s;
    }
    .exit-btn:hover { background: #ad1457; }
    .congrats-card {
      background: #e1bee7;
      border-radius: 18px;
      padding: 32px 24px;
      text-align: center;
      color: #3949ab;
      font-size: 1.2em;
      margin-top: 30px;
      box-shadow: 0 2px 12px rgba(0,0,0,0.06);
      position: relative;
      animation: fadeIn 1.2s;
    }
    .book-emoji {
      font-size: 2.5em;
      margin-bottom: 10px;
      display: block;
    }
  </style>
</head>
<body>
  <div class="triangles-bg">
    <div class="triangle t1">2³</div>
    <div class="triangle t2">√5</div>
    <div class="triangle t3">7</div>
    <div class="triangle t4">3²</div>
    <div class="triangle t5">√16</div>
    <div class="triangle t6">5⁴</div>
    <div class="triangle t7">√9</div>
    <div class="triangle t8">8²</div>
  </div>
  <div id="app"></div>
  <script>
    // Темы для каждого варианта
    const themes = [
      ["Сложение", "Вычитание", "Умножение", "Деление", "Сравнение чисел", "Простые задачи"],
      ["Дроби", "Степени", "Корни", "Геометрия", "Проценты", "Задачи на логику"],
      ["Квадратные уравнения", "Степени и корни", "Тригонометрия", "Функции", "Геометрия", "Сложные задачи"]
    ];

    // Данные для разделов
    const sections = [
      {
        title: "Математика для начинающих (1–4 классы)",
        desc: "Включает простые задания: сложение, вычитание, умножение и деление.",
        tasks: [
          // Для каждой темы свой генератор
          (lvl) => { // Сложение
            const a = Math.floor(Math.random() * (10 + lvl*2)) + 1;
            const b = Math.floor(Math.random() * (10 + lvl*2)) + 1;
            return {
              text: `Вычислите: <b>${a} + ${b}</b>`,
              answer: a + b,
              steps: [
                `Шаг 1: Складываем ${a} и ${b}.`,
                `Шаг 2: ${a} + ${b} = ${a + b}.`,
                `Ответ: ${a + b}.`
              ]
            };
          },
          (lvl) => { // Вычитание
            const a = Math.floor(Math.random() * (10 + lvl*2)) + 5;
            const b = Math.floor(Math.random() * (10 + lvl*2));
            return {
              text: `Вычислите: <b>${a} - ${b}</b>`,
              answer: a - b,
              steps: [
                `Шаг 1: Отнимаем ${b} от ${a}.`,
                `Шаг 2: ${a} - ${b} = ${a - b}.`,
                `Ответ: ${a - b}.`
              ]
            };
          },
          (lvl) => { // Умножение
            const a = Math.floor(Math.random() * 8) + 2;
            const b = Math.floor(Math.random() * 7) + 2;
            return {
              text: `Вычислите: <b>${a} × ${b}</b>`,
              answer: a * b,
              steps: [
                `Шаг 1: Умножение — это сложение числа ${a} ${b} раз.`,
                `Шаг 2: ${a} × ${b} = ${Array(b).fill(a).join(' + ')} = ${a * b}.`,
                `Ответ: ${a * b}.`
              ]
            };
          },
          (lvl) => { // Деление
            const b = Math.floor(Math.random() * 7) + 2;
            const a = b * (Math.floor(Math.random() * 8) + 2);
            return {
              text: `Вычислите: <b>${a} ÷ ${b}</b>`,
              answer: a / b,
              steps: [
                `Шаг 1: Деление — это нахождение, сколько раз число ${b} помещается в ${a}.`,
                `Шаг 2: ${a} ÷ ${b} = ${a / b}.`,
                `Ответ: ${a / b}.`
              ]
            };
          },
          (lvl) => { // Сравнение
            const a = Math.floor(Math.random() * 50) + 1;
            const b = Math.floor(Math.random() * 50) + 1;
            return {
              text: `Что больше: <b>${a}</b> или <b>${b}</b>?`,
              answer: a > b ? `${a}` : `${b}`,
              steps: [
                `Шаг 1: Сравниваем числа ${a} и ${b}.`,
                `Шаг 2: Большее число — ${a > b ? a : b}.`,
                `Ответ: ${a > b ? a : b}.`
              ]
            };
          },
          (lvl) => { // Простая задача
            const apples = Math.floor(Math.random() * 5) + 3;
            const friends = Math.floor(Math.random() * 3) + 2;
            return {
              text: `У Васи ${apples} яблок, он поделил их поровну между ${friends} друзьями. Сколько яблок получил каждый?`,
              answer: (apples / friends).toFixed(2),
              steps: [
                `Шаг 1: Делим ${apples} яблок на ${friends} друзей.`,
                `Шаг 2: ${apples} ÷ ${friends} = ${(apples / friends).toFixed(2)}.`,
                `Ответ: ${(apples / friends).toFixed(2)}.`
              ]
            };
          }
        ]
      },
      {
        title: "Математика для исследователей (5–8 классы)",
        desc: "Включает дроби, степени, корни, задачи на геометрию.",
        tasks: [
          (lvl) => { // Дроби
            const a = Math.floor(Math.random()*9)+1;
            const b = Math.floor(Math.random()*9)+2;
            const gcd = (x, y) => y ? gcd(y, x % y) : x;
            const d = gcd(a*b, b*b);
            return {
              text: `Сократите дробь: <b>${a*b}/${b*b}</b>`,
              answer: `${a}/${b}`,
              steps: [
                `Шаг 1: Найдём НОД числителя и знаменателя (${a*b} и ${b*b}).`,
                `Шаг 2: НОД = ${d}.`,
                `Шаг 3: Делим числитель и знаменатель на НОД: ${a*b}/${b*b} = ${a}/${b}.`,
                `Ответ: ${a}/${b}.`
              ]
            };
          },
          (lvl) => { // Степени
            const base = Math.floor(Math.random()*6)+2;
            const exp = Math.floor(Math.random()*2)+2;
            return {
              text: `Вычислите: <b>${base}<sup>${exp}</sup></b>`,
              answer: Math.pow(base,exp),
              steps: [
                `Шаг 1: Основание степени — ${base}, показатель — ${exp}.`,
                `Шаг 2: ${base}<sup>${exp}</sup> = ${Array(exp).fill(base).join(' × ')} = ${Math.pow(base,exp)}.`,
                `Ответ: ${Math.pow(base,exp)}.`
              ]
            };
          },
          (lvl) => { // Корни
            const num = Math.pow(Math.floor(Math.random()*8)+2,2);
            return {
              text: `Вычислите: <b>√${num}</b>`,
              answer: Math.sqrt(num),
              steps: [
                `Шаг 1: Нужно найти такое число, квадрат которого равен ${num}.`,
                `Шаг 2: √${num} = ${Math.sqrt(num)}.`,
                `Ответ: ${Math.sqrt(num)}.`
              ]
            };
          },
          (lvl) => { // Геометрия
            const side = Math.floor(Math.random()*10)+3;
            return {
              text: `Найдите периметр квадрата со стороной <b>${side}</b>`,
              answer: side*4,
              steps: [
                `Шаг 1: Формула периметра квадрата: 4 × сторона.`,
                `Шаг 2: 4 × ${side} = ${side*4}.`,
                `Ответ: ${side*4}.`
              ]
            };
          },
          (lvl) => { // Проценты
            const total = Math.floor(Math.random()*200)+100;
            const percent = Math.floor(Math.random()*50)+10;
            return {
              text: `Найдите ${percent}% от ${total}`,
              answer: ((total*percent)/100).toFixed(2),
              steps: [
                `Шаг 1: ${percent}% — это ${percent}/100.`,
                `Шаг 2: ${total} × ${percent}/100 = ${(total*percent/100).toFixed(2)}.`,
                `Ответ: ${(total*percent/100).toFixed(2)}.`
              ]
            };
          },
          (lvl) => { // Логика
            return {
              text: `В коробке 3 красных и 2 синих шарика. Сколько всего шариков?`,
              answer: 5,
              steps: [
                `Шаг 1: Складываем количество красных и синих шариков.`,
                `Шаг 2: 3 + 2 = 5.`,
                `Ответ: 5.`
              ]
            };
          }
        ]
      },
      {
        title: "Математика для продвинутых (9–11 классы)",
        desc: "Самые сложные задания по тематикам старших классов России.",
        tasks: [
          (lvl) => { // Квадратные уравнения
            const a = Math.floor(Math.random()*3)+1;
            const b = Math.floor(Math.random()*10)-5;
            const c = Math.floor(Math.random()*10)-5;
            const D = b*b-4*a*c;
            let answer;
            if(D<0) answer="Нет действительных корней";
            else if(D===0) answer=(-b/(2*a)).toFixed(2);
            else answer=`${((-b+Math.sqrt(D))/(2*a)).toFixed(2)}, ${((-b-Math.sqrt(D))/(2*a)).toFixed(2)}`;
            return {
              text: `Решите уравнение: <b>${a}x²${b>=0?'+':''}${b}x${c>=0?'+':''}${c}=0</b>`,
              answer,
              steps: [
                `Шаг 1: Найдём дискриминант: D = b² - 4ac.`,
                `Шаг 2: D = ${b}² - 4×${a}×${c} = ${D}.`,
                D<0
                  ? `Шаг 3: D < 0, действительных корней нет.`
                  : D===0
                    ? `Шаг 3: D = 0, один корень: x = -b/(2a) = ${(-b/(2*a)).toFixed(2)}.`
                    : `Шаг 3: D > 0, два корня: x₁ = ${((-b+Math.sqrt(D))/(2*a)).toFixed(2)}, x₂ = ${((-b-Math.sqrt(D))/(2*a)).toFixed(2)}.`,
                `Ответ: ${answer}.`
              ]
            };
          },
          (lvl) => { // Степени и корни
            const base = Math.floor(Math.random()*10)+2;
            return {
              text: `Вычислите: <b>√${base*base}</b>`,
              answer: base,
              steps: [
                `Шаг 1: √${base*base} — это число, квадрат которого равен ${base*base}.`,
                `Шаг 2: √${base*base} = ${base}.`,
                `Ответ: ${base}.`
              ]
            };
          },
          (lvl) => { // Тригонометрия
            return {
              text: `Вычислите: <b>sin(90°)</b>`,
              answer: 1,
              steps: [
                `Шаг 1: Значение синуса 90° — это 1.`,
                `Ответ: 1.`
              ]
            };
          },
          (lvl) => { // Функции
            const x = Math.floor(Math.random()*10)+1;
            return {
              text: `Вычислите: <b>f(x) = 2x + 3</b> при x = ${x}`,
              answer: 2*x+3,
              steps: [
                `Шаг 1: Подставляем x = ${x} в формулу.`,
                `Шаг 2: 2×${x} + 3 = ${2*x+3}.`,
                `Ответ: ${2*x+3}.`
              ]
            };
          },
          (lvl) => { // Геометрия
            const r = Math.floor(Math.random()*8)+2;
            return {
              text: `Найдите длину окружности радиуса <b>${r}</b> (π ≈ 3.14)`,
              answer: (2*3.14*r).toFixed(2),
              steps: [
                `Шаг 1: Формула длины окружности: 2πr.`,
                `Шаг 2: 2×3.14×${r} = ${(2*3.14*r).toFixed(2)}.`,
                `Ответ: ${(2*3.14*r).toFixed(2)}.`
              ]
            };
          },
          (lvl) => { // Сложные задачи
            return {
              text: `В классе 12 мальчиков и 15 девочек. Сколько всего учеников?`,
              answer: 27,
              steps: [
                `Шаг 1: Складываем количество мальчиков и девочек.`,
                `Шаг 2: 12 + 15 = 27.`,
                `Ответ: 27.`
              ]
            };
          }
        ]
      }
    ];

    // Состояние завершённых тем
    let completedThemes = [[], [], []];

    // Рендеринг
    const app = document.getElementById('app');
    let state = { step: "welcome" };

    function render() {
      if(state.step==="welcome") {
        app.innerHTML = `
          <div class="main-card">
            <div class="main-title">Добро пожаловать на Axel!</div>
            <div class="main-desc">Это оригинальный способ подготовиться к экзамену по математике. Вас ждут интерактивные задания, уникальные методы обучения и увлекательные задачи!</div>
            <button class="btn btn-enter" id="btnEnter">Войти</button>
          </div>
        `;
        document.getElementById('btnEnter').onclick = () => {
          state.step = "sections";
          render();
        };
      } else if(state.step==="sections") {
        app.innerHTML = `
          <div class="main-card">
            <div class="main-title">Выберите вариант</div>
            <div class="section-list">
              ${sections.map((s,i)=>`
                <div class="section-card">
                  <div class="section-title">${s.title}</div>
                  <div class="section-desc">${s.desc}</div>
                  <button class="btn-section" data-idx="${i}">Войти в вариант</button>
                </div>
              `).join('')}
            </div>
            <button class="exit-btn" id="exitApp">Выйти</button>
          </div>
        `;
        document.querySelectorAll('.btn-section').forEach(btn=>{
          btn.onclick = () => {
            state.section = +btn.dataset.idx;
            state.step = "themes";
            render();
          };
        });
        document.getElementById('exitApp').onclick = () => {
          state.step = "welcome";
          render();
        };
      } else if(state.step==="themes") {
        app.innerHTML = `
          <div class="main-card">
            <div class="main-title">${sections[state.section].title}</div>
            <div class="section-desc">${sections[state.section].desc}</div>
            <div class="options-list">
              ${themes[state.section].map((theme, i) => `
                <div class="option-card" data-idx="${i}">
                  ${theme}
                  ${completedThemes[state.section][i] ? '<span class="completed">✔</span>' : ''}
                </div>
              `).join('')}
            </div>
            <button class="exit-btn" id="exitSection">Выйти из варианта</button>
          </div>
        `;
        document.querySelectorAll('.option-card').forEach(btn=>{
          btn.onclick = () => {
            state.theme = +btn.dataset.idx;
            state.taskIdx = 0;
            state.step = "task";
            render();
          };
        });
        document.getElementById('exitSection').onclick = () => {
          state.step = "sections";
          render();
        };
      } else if(state.step==="task") {
        // Генерируем задание
        const lvl = state.taskIdx;
        const taskGen = sections[state.section].tasks[state.theme];
        const task = taskGen(lvl);
        app.innerHTML = `
          <div class="main-card">
            <div class="main-title">Тема: ${themes[state.section][state.theme]}</div>
            <div class="task-card">
              <div class="task-title">${task.text}</div>
              <input class="task-input" id="taskInput" autocomplete="off" />
              <button class="btn-check" id="btnCheck">Проверить</button>
              <div id="taskResult"></div>
            </div>
            <button class="exit-btn" id="exitTheme">Выйти из темы</button>
          </div>
        `;
        document.getElementById('exitTheme').onclick = () => {
          state.step = "themes";
          render();
        };
        document.getElementById('btnCheck').onclick = () => {
          const val = document.getElementById('taskInput').value.trim();
          let correct = false;
          if(typeof task.answer === "number") correct = Number(val) === task.answer;
          else correct = val === String(task.answer);
          const result = document.getElementById('taskResult');
          if(correct) {
            result.innerHTML = `<button class="btn-next" id="btnNext">Продолжить</button>`;
            document.getElementById('btnNext').onclick = () => {
              if(state.taskIdx<9) {
                state.taskIdx++;
                render();
              } else {
                completedThemes[state.section][state.theme] = true;
                state.step = "congrats";
                render();
              }
            };
          } else {
            // Этапное объяснение
            let stepIdx = 0;
            function showStep() {
              result.innerHTML = `<div class="explanation">${task.steps[stepIdx]}</div>` +
                (stepIdx < task.steps.length - 1
                  ? `<button class="btn-next" id="btnStepNext">Следующий шаг</button>`
                  : "");
              if (stepIdx < task.steps.length - 1) {
                document.getElementById('btnStepNext').onclick = () => {
                  stepIdx++;
                  showStep();
                };
              }
            }
            showStep();
          }
        };
      } else if(state.step==="congrats") {
        app.innerHTML = `
          <div class="main-card congrats-card">
            <span class="book-emoji">📚</span>
            <div>Поздравляем! Вы завершили тему <b>${themes[state.section][state.theme]}</b>!</div>
            <div>Вы — молодец! Продолжайте учиться и достигать новых успехов!</div>
            <button class="btn-next" id="btnToThemes">К темам</button>
          </div>
        `;
        document.getElementById('btnToThemes').onclick = () => {
          state.step = "themes";
          render();
        };
      }
    }
    render();
  </script>
</body>
</html>
